## 7.5 Holt-Winters 계절적인 기법

Holt (1957)와 Winters (1960)는 계절성을 고려하기 위해 Holt의 기법을 확장하였다. Holt-Winters 계절적인 기법은 예측식과 3개의 평활식으로 구성된다. 하나는 수준 $$l_{t}$$에 대한 것, 하나는 추세 $$b_{t}$$에 대한 것, $$s_{t}$$로 나타내고 평활 매개변수 $$\alpha$$, $$\beta^{*}$$ 그리고 $$\gamma$$를 고려하는 계절적인 성분이다. $$m$$을 계절성의 주기로 표시하자. 즉, 한 해의 계절의 수 같이 말이다. 예를 들면, 4분기 데이터에서는 $$m=4$$이고, 월별 데이터에서는 $$m=12$$이다.

계절적인 성분의 성질에 따라 이 기법에 두 가지 변형이 있다. 덧셈 기법은 계절적인 변동이 시계열 전반에 걸쳐 거의 일정할 때 사용하고, 곱셈 기법은 계절적인 변동이 시계열의 수준에 비례하게 변할 때 사용한다. 덧셈 기법에서 계절적인 성분은 관측된 시계열의 척도로 나타내고, 수준식에서 계절적인 성분을 빼서 시계열을 계절적으로 조절한다. 각 연도 내에서 계절적인 성분은 근사적으로 0에 맞춰질 것이다. 곱셈 기법에서, 계절적인 성분은 상대적인 항(비율)으로 표현하고 시계열은 계절적인 성분으로 나누어 계절적으로 조절한다. 각 연도 안에서 계절적인 성분은 근사적으로 $$m$$으로 맞춰질 것이다.

### Holt-Winters 덧셈 기법

덧셈 기법에 대한 성분 형태는

$$
\begin{align*}
\hat{y})_{t+h \vert t} & = l_{t} + h b_{t} + s_{t-m \vert + h_{m}^{+} } \\
l_{t} & = \alpha (y_{t} - s_{t-m}) + (1-\alpha)(l_{t-1} + b_{t-1}) \\
b_{t} & = \beta^{*} (l_{t} - l_{t-1}) + (1-\beta^{*})b_{t-1} \\
s_{t} & = \gamma (y_{t} - l_{t-1} - b_{t-1}) + (1-\gamma)s_{t-m},
\end{align*}
$$

여기에서 $$ h_{m}^{+} = \lfloor (h-1) \mod m \rfloor + 1 $$ 이고, 이것이 예측을 위한 계절적인 지수 추정이 표본의 마지막 연도에서 유래한다는 것을 보장한다. $$ \lfloor u \rfloor $$는 $$u$$보다 크지 않은 가장 큰 정수이다. 수준식은 계절적으로 조절된 관측값 ( $$y_{t}-s_{t-m}$$ ) 사이의 가중 평균과 시간 $$t$$에 대한 비-게절적인 예측 ($$l_{t-1}+b_{t-1}$$)을 나타낸다. 추세식은 Holt의 선형 기법과 같다. 계절적인 식은 현재 계절적인 지표( $$y_{t}-l_{t-1}-b_{t-1}$$ )와 이전 연도 같은 계절(즉, $$m$$ 주기 이전)의 계절적인 지표 사이의 가중 평균을 나타낸다.

계절적인 성분에 대한 식은 종종 다음과 같이 나타낸다.

$$
s_{t} = \gamma^{*}(y_{t}-l_{t}) + (1-\gamma^{*})s_{t-m}.
$$

만약에 평활식에서 l_{t}를 위의 성분 형태의 수준에 대입하면,

$$
s_{t} = \gamma^{*}(1-\alpha)(y_{t} - l_{t-1} - b_{t-1}) + \left[ 1 - \gamma^{*}(1-\alpha) \right]s_{t-m}
$$

위의 식은 계절적인 성분에 대한 평활식과 같다. 여기에서 $$ \gamma = \gamma^{*}(1-\alpha) $$로 다시 쓸 수 있고, 보통의 매개변수 제한 조건은 $$ 0 \le \gamma^{*} \le 1 $$인데, $$ 0 \le \gamma \le 1- \alpha $$가 된다.

평활식의 오차 보정 형태는

$$
\begin{align*}
l_{t} & = l_{t-1} + b_{t-1} + \alpha e_{t} \\
b_{t} & = b_{t-1} + \alpha \beta^{*} e_{t} \\
s_{t} & = s_{t-m} + \gamma e_{t}.
\end{align*}
$$

여기에서 $$ e_{t} = y_{t} - \left( l_{t-1} + b_{t-1} + s_{t-m} \right) = y_{t} - \hat{y}_{t \vert t-1} $$은 한 단계 훈련 예측 오차이다.


### Holt-Winters 곱셈 기법
곱셈 기법에 대한 성분 형태는

$$
\begin{align*}
\hat{y}_{t+h \vert t} & = \left( l_{t} + h b_{t} \right) s_{t-m \vert + h_{m}^{+} } \\
l_{t} & = \alpha \frac{ y_{t} }{ s_{t-m} } + (1-\alpha)(l_{t-1} + b_{t-1}) \\
b_{t} & = \beta^{*} (l_{t} - l_{t-1}) + (1-\beta^{*})b_{t-1} \\
s_{t} & = \gamma \frac{ y_{t} }{ l_{t-1} + b_{t-1} } + (1-\gamma)s_{t-m},
\end{align*}
$$

그리고 오차 보정 표현은 다음과 같다.

$$
\begin{align*}
l_{t} & = l_{t-1} + b_{t-1} + \alpha \frac{ e_{t} }{ s_{t-m} } \\
b_{t} & = b_{t-1} + \alpha \beta^{*} \frac{ e_{t} }{ s_{t-m} } \\
s_{t} & = s_{t-m} + \gamma \frac{ e_{t} }{ \left( l_{t-1} + b_{t-1} \right) }.
\end{align*}
$$

여기에서 $$ e_{t} = y_{t} - \left( l_{t-1} + b_{t-1} \right) s_{t-m} $$이다.


### 예제 7.4 호주를 방문하는 국제 여행객 숙박일 수

![](https://www.otexts.org/sites/default/files/resize/fpp/images/fig_7_HW-570x360.png)

그림 7.6: 덧셈과 곱셈 계절성 두 경우의 Holt-Winters 기법을 이용하여 호주를 방문하는 국제 여행객 숙박일 수 예측.

```R
aust <- window(austourists,start=2005)
fit1 <- hw(aust,seasonal="additive")
fit2 <- hw(aust,seasonal="multiplicative")

plot(fit2,ylab="International visitor night in Australia (millions)",
     plot.conf=FALSE, type="o", fcol="white", xlab="Year")

lines(fitted(fit1), col="red", lty=2)
lines(fitted(fit2), col="green", lty=2)

lines(fit1$mean, type="o", col="red")
lines(fit2$mean, type="o", col="green")

legend("topleft",lty=1, pch=1, col=1:3, 
  c("data","Holt Winters' Additive","Holt Winters' Multiplicative"))
```

이 예제에서는 호주에서 국제선 항공편 승객의 숙박일 수 예측을 위해 덧셈과 곱셈 계절성 두 경우에 Holt-Winters 기법을 도입하였다. 그림 7.6은 2005년 1분기부터 2010년 4분기까지의 표본 내 한 단계 예측과 데이터를 같이 나타낸 것과 2011년 1분기와 2012년 4분기에 대한 예측을 나타낸 것이다. 데이터에서 분명한 호주의 여름인 매년 3월이 성수기로 나타나는 계절적인 패턴이 보인다.

덧셈과 곱셈 계절성을 가지고 이 기법을 응용한 결과를 표 7.5와 7.6에 각각 나타내었다. 결과를 통해 곱셉 계절성이 데이터에 더 잘 맞는다는 것을 알 수 있다. 시계열의 수준이 증가하면서 데이터에 나타나는 계절적인 변동이 증가하는 것을 보여주는 도표를 보고 예상할 수 있었던 사실이다. 이 결과는 두 가지 예측 집합도 보여준다. 덧셈 계절성을 이용하여 얻은 예측 결과와 비교할 때, 곱셈 계절성을 이용한 기법으로 예측한 결과가 예측값의 수준이 증가함에 따라 더 크고 증가하는 계절적인 변동을 나타낸다.


표 7.5 

| 분기-연도 | $$ t $$ | $$ y_{t} $$ | $$ l_{t} $$ | $$ b_{t} $$ | $$ s_{t} $$ | $$ \hat{y}_{t} $$ |
|--------|----|--|--|---|------|---|
| 3월-04 | -3 |  |  |   | 10.7 |   |
| 6월-04 | -2 |   |   |   | -9.5 |   |
| 9월-04 | -1 |   |   |   | -2.6 |   |
| 12월-04 | 0 |   | 33.8 | 0.65 | 1.4 |   |
| 3월-05 | 1 | 41.7 | 34.4 | 0.57 | 10.7 | 45.1 |
| 6월-05 | 2 | 24.0 | 34.9 | 0.53 | -9.5 | 25.5 |
| 9월-05 | 3 | 32.3 | 35.4 | 0.52 | -2.6 | 32.9 |
| 12월-05 | 4 | 37.3 | 35.9 | 0.52 | 1.4 | 37.3 |
| 3월-06 | 5 | 46.2 | 36.4 | 0.50 | 10.7 | 47.1 |
| 6월-06 | 6 | 29.3 | 37.0 | 0.54 | -9.5 | 27.5 |
| 9월-06 | 7 | 36.5 | 37.6 | 0.58 | -2.6 | 35.0 |
| 12월-06 | 8 | 43.0 | 38.2 | 0.66 | 1.4 | 39.5 |
| 3월-07 | 9 | 48.9 | 38.9 | 0.64 | 10.7 | 49.6 |
| 6월-07 | 10 | 31.2 | 39.6 | 0.67 | -9.5 | 30.0 |
| 9월-07 | 11 | 37.7 | 40.2 | 0.67 | -2.6 | 37.7 |
| 12월-07 | 12 | 40.4 | 40.9 | 0.63 | 1.4 | 42.3 |
| 3월-08 | 13 | 51.2 | 41.5 | 0.61 | 10.7 | 52.1 |
| 6월-08 | 14 | 31.9 | 42.0 | 0.59 | -9.5 | 32.6 |
| 9월-08 | 15 | 41.0 | 42.7 | 0.61 | -2.6 | 40.1 |
| 12월-08 | 16 | 43.8 | 43.2 | 0.59 | 1.4 | 44.7 |
| 3월-09 | 17 | 55.6 | 43.9 | 0.62 | 10.7 | 54.5 |
| 6월-09 | 18 | 33.9 | 44.4 | 0.59 | -9.5 | 35.0 |
| 9월-09 | 19 | 42.1 | 45.0 | 0.58 | -2.6 | 42.5 |
| 12월-09 | 20 | 45.6 | 45.6 | 0.55 | 1.4 | 47.0 |
| 3월-10 | 21 | 59.8 | 46.2 | 0.62 | 10.7 | 56.8 |
| 6월-10 | 22 | 35.2 | 46.8 | 0.57 | -9.5 | 37.3 |
| 9월-10 | 23 | 44.3 | 47.3 | 0.56 | -2.6 | 44.8 |
| 12월-10 | 24 | 47.9 | 47.8 | 0.53 | 1.4 | 49.3 |
|  | $$ h $$ |  |  |  |  | $$ y_{T+h \vert T} $$ |
| 3월-11 | 1 |  |  |  |  | 59.0 |
| 6월-11 | 2 |  |  |  |  | 39.4 |
| 9월-11 | 3 |  |  |  |  | 46.9 |
| 12월-11 | 4 |  |  |  |  | 51.3 |
| 3월-12 | 5 |  |  |  |  | 61.1 |
| 6월-12 | 6 |  |  |  |  | 41.5 |
| 9월-12 | 7 |  |  |  |  | 49.0 |
| 12월-12 | 8 |  |  |  |  | 53.4 |

표 7.6

| 분기-연도 | $$t$$ | $$y_{t}$$ | $$l_{t}$$ | $$b_{t}$$ | $$s_{t}$$ | $$ \hat{y}_{t} $$ |
|----------|----|------|--------|------|------|--------|
| 3월-04 | -3 |  |  |  | 1.3 |  |
| 6월-04 | -2 |  |  |  | 0.8 |  |
| 9월-04 | -1 |  |  |  | 0.9 |  |
| 12월-04 | 0 |  | 32.2 | 0.93 | 1.0 |  |
| 3월-05 | 1 | 41.7 | 33.1 | 0.93 | 1.3 | 41.8 |
| 6월-05 | 2 | 24.0 | 32.9 | 0.78 | 0.8 | 25.9 |
| 9월-05 | 3 | 32.3 | 33.9 | 0.81 | 0.9 | 31.9 |
| 12월-05 | 4 | 37.3 | 35.4 | 0.91 | 1.0 | 35.7 |
| 3월-06 | 5 | 46.2 | 36.4 | 0.92 | 1.3 | 45.9 |
| 6월-06 | 6 | 29.3 | 37.9 | 1.00 | 0.8 | 28.4 |
| 9월-06 | 7 | 36.5 | 38.7 | 0.98 | 0.9 | 36.8 |
| 12월-06 | 8 | 43.0 | 40.6 | 1.11 | 1.0 | 40.8 |
| 3월-07 | 9 | 48.9 | 40.4 | 0.92 | 1.3 | 52.7 |
| 6월-07 | 10 | 31.2 | 41.2 | 0.90 | 0.8 | 31.5 |
| 9월-07 | 11 | 37.7 | 41.1 | 0.76 | 0.9 | 39.8 |
| 12월-07 | 12 | 40.4 | 40.8 | 0.60 | 1.0 | 43.0 |
| 3월-08 | 13 | 51.2 | 41.0 | 0.54 | 1.3 | 52.3 |
| 6월-08 | 14 | 31.9 | 41.7 | 0.57 | 0.8 | 31.6 |
| 9월-08 | 15 | 41.0 | 42.7 | 0.63 | 0.9 | 40.0 |
| 12월-08 | 16 | 43.8 | 43.0 | 0.58 | 1.0 | 44.6 |
| 3월-09 | 17 | 55.6 | 43.7 | 0.61 | 1.3 | 55.1 |
| 6월-09 | 18 | 33.9 | 44.4 | 0.61 | 0.8 | 33.8 |
| 9월-09 | 19 | 42.1 | 44.8 | 0.58 | 0.9 | 42.6 |
| 12월-09 | 20 | 45.6 | 44.9 | 0.52 | 1.0 | 46.6 |
| 3월-10 | 21 | 59.8 | 46.2 | 0.63 | 1.3 | 57.5 |
| 6월-10 | 22 | 35.2 | 46.6 | 0.59 | 0.8 | 35.7 |
| 9월-10 | 23 | 44.3 | 47.0 | 0.57 | 0.9 | 44.6 |
| 12월-10 | 24 | 47.9 | 47.2 | 0.51 | 1.0 | 48.9 |
|  | $$h$$ |  |  |  | | $$ y_{T+h \vert T} $$ |
| 3월-11 | 1 |  |  |  |  | 60.3 |
| 6월-11 | 2 |  |  |  |  | 36.7 |
| 9월-11 | 3 |  |  |  |  | 46.1 |
| 12월-11 | 4 |  |  |  |  | 50.6 |
| 3월-12 | 5 |  |  |  |  | 62.8 |
| 6월-12 | 6 |  |  |  |  | 38.2 |
| 9월-12 | 7 |  |  |  |  | 48.2 |
| 12월-12 | 8 |  |  |  |  | 52.7 |

![](https://www.otexts.org/sites/default/files/resize/fpp/images/fig_7_LevelTrendSeas-570x329.png)

그림 7.7: 덧셈과 곱셈 계절적인 성분의 Holt-Winters 기법에 대해 추정된 성분들.

```R
states <- cbind(fit1$model$states[,1:3],fit2$model$states[,1:3])
colnames(states) <- c("level","slope","seasonal","level","slope","seasonal")
plot(states, xlab="Year")
fit1$model$state[,1:3]
fitted(fit1)
fit1$mean
```

### Holt-Winters 감쇠 기법

계절적인 데이터에 대해 단일 기법으로는 가장 정확한 예측을 주는 감쇠 추세와 곱셈 계절성의 Holt-Winters 기법은 다음과 같다.

$$
\begin{align*}
\hat{y}_{t+h \vert t} & = \left[ l_{t} + \left( \phi + \phi^{2} + \cdots + \phi^{h} \right) b_{t} \right]s_{t-m + h_{m}^{+}} \\
l_{t} & = \alpha \frac{ y_{t} }{ s_{t-m} } + (1-\alpha)( l_{t-1} + \phi b_{t-1} ) \\
b_{t} & = \beta^{*} (l_{t} - l_{t-1}) + (1 - \beta^{*})\phi b_{t-1} \\
s_{t} & = \gamma \frac{ y_{t} }{ \left( l_{t-1} + \phi b_{t-1} \right) } + (1-\gamma)s_{t-m}.
\end{align*}
$$

